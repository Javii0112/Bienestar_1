{% extends 'base.html' %}

{% block title %}Dashboard | Bienestar Campus{% endblock %}

{% block page_name %}Inicio{% endblock %}

{% block content %}

<!-- ===== BANNER ===== -->
<div class="banner">
    <h2>"Cada dÃ­a es una nueva oportunidad"</h2>
    <p>Recuerda: tu bienestar es una prioridad ğŸ’š</p>
</div>

<!-- ===== GRID ===== -->
<div class="grid">
    <!-- REGISTRO EMOCIÃ“N -->
    <div class="card">
        <h3>ğŸ§  Registro de EmociÃ³n</h3>

        <form method="post">
            {% csrf_token %}

            <label>EmociÃ³n</label>
            <select name="emocion" required>
                <option value="">Selecciona una emociÃ³n</option>
                {% for emocion in emociones %}
                    <option value="{{ emocion.id }}">{{ emocion.nombre }}</option>
                {% endfor %}
            </select>

            <label>Intensidad (1 a 5)</label>
            <select name="intensidad" required>
                <option value="">Selecciona intensidad</option>
                <option value="1">1 - Muy leve</option>
                <option value="2">2 - Leve</option>
                <option value="3">3 - Moderada</option>
                <option value="4">4 - Intensa</option>
                <option value="5">5 - Muy intensa</option>
            </select>

            <label>CuÃ©ntanos un poco mÃ¡s</label>
            <textarea name="descripcion" rows="3" placeholder="Â¿QuÃ© estÃ¡ pasando hoy?"></textarea>

            <button type="submit" name="guardar_emocion" value="1">Guardar emociÃ³n</button>
        </form>
    </div>

    <!-- RESUMEN -->
    <div class="card">
        <h3>ğŸ“Š Resumen de Hoy</h3>

        {% if emocion_hoy %}
            <div class="resumen-item">
                <span>ğŸ§  EmociÃ³n</span>
                <span>{{ emocion_hoy.emocion.nombre }} (intensidad {{ emocion_hoy.intensidad }}/5)</span>
            </div>
        {% else %}
            <div class="resumen-item">
                <span>ğŸ§  EmociÃ³n</span>
                <span style="color: #aaa;">Sin registrar aÃºn</span>
            </div>
        {% endif %}

        {% if habitos_hoy %}
            {% for reg in habitos_hoy %}
            <div class="resumen-item">
                <span>ğŸ’ª {{ reg.habito.nombre }}</span>
                <span>{{ reg.valor }} min</span>
            </div>
            {% endfor %}
        {% else %}
            <div class="resumen-item">
                <span>ğŸ’ª HÃ¡bitos</span>
                <span style="color: #aaa;">Sin registrar aÃºn</span>
            </div>
        {% endif %}

        {% if todas_emociones %}
        <button onclick="document.getElementById('historial').style.display = document.getElementById('historial').style.display === 'none' ? 'block' : 'none'"
            style="margin-top: 12px; background: transparent; border: 1px solid #00796b; color: #00796b; padding: 6px 14px; border-radius: 8px; cursor: pointer; font-size: 13px;">
            ğŸ“‹ Ver historial de emociones
        </button>

        <div id="historial" style="display: none; margin-top: 12px;">
            {% for reg in todas_emociones %}
            <div style="display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #eee; font-size: 14px;">
                <span>{{ reg.emocion.nombre }}</span>
                <span style="color: #888;">{{ reg.intensidad }}/5 Â· {{ reg.fecha|date:"d/m H:i" }}</span>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <a href="{% url 'habitos' %}">
            <button class="btn-habitos">Registrar mÃ¡s hÃ¡bitos</button>
        </a>
    </div>

</div> <!-- cierre div.grid -->

<!-- ===== ACTIVIDADES ===== -->
<div class="actividades">
    <h3>âœ¨ Actividades recomendadas para ti</h3>

    <div class="actividades-grid">
        <div class="actividad act1">ğŸ§˜ MeditaciÃ³n<br><small>5 min respiraciÃ³n</small></div>
        <div class="actividad act2">âœï¸ Escribe<br><small>Expresa tus ideas</small></div>
        <div class="actividad act3">ğŸš¶ Camina<br><small>15 min al aire libre</small></div>
    </div>
</div>

<!-- ===== ACCESOS ===== -->
<div class="accesos">
    <a href="{% url 'estadistica' %}" style="text-decoration: none; color: inherit;">
        <div class="acceso">ğŸ“Š Ver EstadÃ­sticas</div>
    </a>
    <a href="{% url 'diario' %}" style="text-decoration: none; color: inherit;">
        <div class="acceso">ğŸ“” Mi Diario</div>
    </a>
    <div class="acceso">ğŸ“š Recursos</div>
    <div class="acceso">ğŸ† Mis Logros</div>
</div>

{% endblock %}